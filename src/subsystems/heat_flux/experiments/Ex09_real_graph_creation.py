import tensorflow_gnn as tfgnn



# %%
"""
--> Creation of the real graph template
"""


graph_ref = tfgnn.GraphTensor.from_pieces(
    context=tfgnn.Context.from_fields(
        features={'time': [0.],
                  'time_step': [0.2],
                  'specific heat capacity': [1.],
                  'static_heat': [0.2]}),

    node_sets={"cells": tfgnn.NodeSet.from_fields(sizes=[20],
                                                  features={
                                                      "T": [1.90, 1.90, 1.90, 1.90, 1.90,
                                                            1.90, 1.90, 1.90, 1.90, 1.90,
                                                            1.90, 1.90, 1.90, 1.90, 1.90,
                                                            1.90, 1.90, 1.90, 1.90, 1.90],

                                                      # "Q": [0., 0., 0., 0., 0.,
                                                      #       0., 0., 0., 0., 0.,
                                                      #       0., 0., 0., 0., 0.,
                                                      #       0., 0., 0., 0., 0.],

                                                      "mass": [36.,
                                                               21.75, 14.5, 21.75,
                                                               21.75, 14.5, 21.75,
                                                               21.75, 14.5, 21.75,
                                                               36,
                                                               21.75, 14.5, 21.75,
                                                               21.75, 14.5, 21.75,
                                                               21.75, 14.5, 21.75,],
                                                      'L': [6.,
                                                            5., 5., 5.,
                                                            5., 5., 5.,
                                                            5., 5., 5.,
                                                            6.,
                                                            5., 5., 5.,
                                                            5., 5., 5.,
                                                            5., 5., 5.]
                                                  }),
               "heater": tfgnn.NodeSet.from_fields(sizes=[8],
                                                   features={
                                                       "power": [1., 1., 1., 1., 1., 1., 1., 1.],
                                                   }),
               "liquid": tfgnn.NodeSet.from_fields(sizes=[20],
                                                   features={
                                                       "extraction capacity": [0.,
                                                                               0., 0., 0.,
                                                                               0., 0., 0.,
                                                                               0., 0., 0.,
                                                                               0.,
                                                                               0., 0., 0.,
                                                                               5., 5., 5.,
                                                                               5., 5., 5.],
                                                       "T": [1.85,
                                                             1.85, 1.85, 1.85,
                                                             1.85, 1.85, 1.85,
                                                             1.85, 1.85, 1.85,
                                                             1.85,
                                                             1.85, 1.85, 1.85,
                                                             1.85, 1.85, 1.85,
                                                             1.85, 1.85, 1.85]
                                                   })},
    edge_sets={"conduction": tfgnn.EdgeSet.from_fields(sizes=[38],
                                                       features={
                                                           "conductivity": [100., 100., 100., 100., 100., 100.,
                                                                            100., 100., 100., 100., 100., 100.,
                                                                            100., 100., 100., 100., 100., 100.,
                                                                            100., 100., 100., 100., 100., 100.,
                                                                            100., 100., 100., 100., 100., 100.,
                                                                            100., 100., 100., 100., 100., 100.,
                                                                            100., 100.],

                                                           "L": [6.1, 5., 5., 5.6, 5., 5.,
                                                                 5.6, 5., 5., 6.1, 6.1, 5.,
                                                                 5., 5.6, 5., 5., 5.6, 5., 5.],
                                                           "A": [0.0030,
                                                                 0.0150, 0.0150, 0.0030,
                                                                 0.0150, 0.0150, 0.0030,
                                                                 0.0150, 0.0150, 0.0030,
                                                                 0.0030,
                                                                 0.0150, 0.0150, 0.0030,
                                                                 0.0150, 0.0150, 0.0030,
                                                                 0.0150, 0.150],
                                                           # "E_transf": [0., 0., 0., 0., 0., 0.],
                                                           # "Q_transf": [0., 0., 0., 0., 0., 0.]
                                                       },
                                                       adjacency=tfgnn.Adjacency.from_indices(
                                                           source=("cells", [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                                                                             1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]),
                                                           target=("cells", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                                                                             0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]))
                                                       ),
               "heat supplied": tfgnn.EdgeSet.from_fields(sizes=[8],
                                                          features={},
                                                          adjacency=tfgnn.Adjacency.from_indices(
                                                              source=("heater", [0, 1, 2, 3, 4, 5, 6, 7]),
                                                              target=("cells", [0, 1, 4, 7, 10, 11, 14, 17])
                                                          )),
               "cell2liquid": tfgnn.EdgeSet.from_fields(sizes=[20],
                                                           features={
                                                               "conductivity": [1200., 1200., 1200., 1200., 1200.,
                                                                                1200., 1200., 1200., 1200., 1200.,
                                                                                1200., 1200., 1200., 1200., 1200.,
                                                                                1200., 1200., 1200., 1200., 1200.],
                                                           },
                                                           adjacency=tfgnn.Adjacency.from_indices(
                                                               source=("cells", [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]),
                                                               target=("liquid", [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19])
                                                           ))}
)


